# 세그먼트 트리

## SEGMENT = > 분절

트리는 효율적 자료구조의 사용을 위해 사용된다.

세그먼트 트리는 “구간을 저장하기 위한 트리”이다.

구간 마다의 값을 저장하는 트리이다.

## 트리 생성

먼저 효율적 메모리 할당을 위해 크기, 높이를 정해야 한다.

> N = 리프 노드의 개수
>
> > 1. 세그먼트 트리의 높이 => ceil(log(N)) // ceil == 올림값
> > 2. 세그먼트 트리의 크기 => 1<<(트리의 높이 +1) // 2의 제곱

리프 노드 => 배열 값

다른 노드 => 배열의 합

그러면 트리를 생성할 때 노드의 번호와 노드 값만 넣으면
트리가 완성되는데
세그먼트 트리는 재귀를 통해 번호와 값이 결정된다.

배열의 중간 값을 기준으로 왼쪽과 오른쪽이 하나가 남을 때까지 반복한다.

그리고 트리의 노드 번호는 재귀를 실행할 때의 매개 변수로 정해지는데,

매개변수를 x라고 했을 때,

왼쪽 노드 => 2x

오른쪽 노드 => 2x + 1이다

## 트리의 탐색

> 구간을 찾을 때 3가지 경우로 나뉜다.
>
> > 1.  탐색하는 범위가 찾고자 하는 구간과 완전히 겹치지 않는 경우
> > 2.  탐색하는 범위가 참고자 하는 구간에 완전히 속해있는 경우
> > 3.  1, 2번 경우를 제외한 나머지의 경우, 즉 일부만 걸쳐 있는 경우

> 이를 재귀를 통해 구현한다.
>
> > 구간 확인 => 1번인 경우 => 바로 0 리턴
> > 구간 확인 => 2번인 경우 => 해당 노드 값을 리턴
> > 구간 확인 => 3번인 경우 => 다시 왼쪽 노드, 오른쪽 노드로 재귀 실행

> 값이 리턴 되는 경우 =
>
> > 왼쪽노드와 오른쪽 노드의 합,즉 3번인 경우
> > 해당 노드가 완전히 속한 경우, 즉 2번인 경우
> > 두 경우뿐이다.

## 트리의 변경

세그먼트 트리는 연산의 결과를 저장한 트리
값 변경 시 해당 노드 뿐만 아니라
영향을 받은 노드들의 값이 변경해야 한다.

> 값 변경 시 2가지 경우로 나누어 생각할 수 있다.
>
> > 1.  바꾸고자 하는 Index값이, 탐색하는 범위 내에 속해있는 경우
> > 2.  바꾸고자 하는 Index값이, 탐색하는 범위 내에 속해있지 않은 경우

> 탐색과 마찮가지로 재귀를 통해 이루어진다.
>
> > 속해있지 않은 경우 => 0을 리턴
> > 속한 경우 => 해당 노드 값 바꾸고 깊이 탐색

\*깊이 탐색 => 또 중간 값 기준으로 왼쪽, 오른쪽
